<%
  # Note: this is a .json.erb file. So we evaluate it with Erb, which results
  # in JSON. If you've used Erb in Rails' database.yml, this is basically the
  # same thing.

  # Here, we get to run appropriate Ruby code of whatever kind we like.  For
  # instance, anything you've put into ~/.deploy_credentials is fair game for
  # loading. You may want your passwords there!

  # Keep in mind that this code loads in both Capistrano and Chef.  Try not to
  # put in Cap-specific code (fails in Chef) or Chef-specific code (fails in
  # Capistrano.) When in doubt, create a new Vagrant VM from scratch using
  # both Chef and Capistrano as a test.
%>

{
  "rails_apps": {
    "rails-devise-pundit": {
      "git": "git@github.com:noahgibbs/rails-devise-pundit.git",
      "#TODO": "more git configuration - see Capistrano files",
      "#TODO": "optionally specify no asset build and/or no migration",
      "user": "www",

      "#": "These are insecure right now and must all be changed",
      "#": "This is a .json.erb file, so you could load them from ~/.deploy_credentials",
      "#TODO": "Generate the secret keys repeatably and cross-platform in ~/.deploy_credentials",
      "env_vars": {
        "ADMIN_NAME": "admin",
        "ADMIN_EMAIL": "admin@no-such-domain.no-such-tld",
        "ADMIN_PASSWORD": "s00p3rs33kr1t",
        "GMAIL_USERNAME": "the.codefolio.guy",
        "GMAIL_PASSWORD": "notMyR34lP455w0rD$",
        "DOMAIN_NAME": "codefol.io",
        "SECRET_KEY_BASE": "5c2d20f4f56f5ba4012e70a9a2a0ad9b0fabfca15a3ffa4e6dc5b5b9df962f9350a544d35b08fefd55f5f1126b04654ac6ba778c7ae165b3234109322dfbefe9"
      },

      "#": "uncomment these to use them",
      "#unicorn_arguments": "arguments passed to unicorn",
      "#log_run_arguments": "arguments passed to svlogd (runit)",
      "#chpst_arguments":   "arguments passed to chpst (runit)",
      "#extra_code":        "bash commands at start of run script (runit)",
      "#extra_log_code":    "bash commands at start of log script (runit)",

      "#": "An app can list what Ubuntu packages to install. [NOT YET IMPLEMENTED]",
      "packages": []
    }
  },
  "users": {
    "www": {
    }
  },
  "nginx": {
    "#": "See docs at http://community.opscode.com/cookbooks/nginx",
    "version": "1.4.4",
    "default_site_enabled": false
  },
  "mysql": {
    "#": "See http://community.opscode.com/cookbooks/mysql",
    "server_root_password": "iloverandompasswords",
    "allow_remote_root": false
  },
  "rvm": {
    "#": "See https://github.com/fnichol/chef-rvm",
    "#TODO": "Do we need to worry about a user_installs list?",
    "vagrant": {
        "system_chef_solo": "/opt/vagrant_ruby/bin/chef-solo"
    }
  },
  "run_list": [
    "apt",
    "mysql::client",
    "mysql::server",
    "basic_config",
    "rvm",
    "nginx::source",
    "rails_server"
  ]
}
